{"ast":null,"code":"import db from '@/lib/firebase';\nexport default (async (req, res) => {\n  if (req.method === 'POST') {\n    const ref = db.ref('views').child(req.query.slug);\n    const {\n      snapshot\n    } = await ref.transaction(currentViews => {\n      if (currentViews === null) {\n        return 1;\n      }\n\n      return currentViews + 1;\n    });\n    return res.status(200).json({\n      total: snapshot.val()\n    });\n  }\n\n  if (req.method === 'GET') {\n    const snapshot = await db.ref('views').child(req.query.slug).once('value');\n    const views = snapshot.val();\n    return res.status(200).json({\n      total: views\n    });\n  }\n});","map":{"version":3,"sources":["/Users/withoutwax/Project/withoutwax.me/pages/api/views/[slug].js"],"names":["db","req","res","method","ref","child","query","slug","snapshot","transaction","currentViews","status","json","total","val","once","views"],"mappings":"AAAA,OAAOA,EAAP,MAAe,gBAAf;AAEA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB,UAAMC,GAAG,GAAGJ,EAAE,CAACI,GAAH,CAAO,OAAP,EAAgBC,KAAhB,CAAsBJ,GAAG,CAACK,KAAJ,CAAUC,IAAhC,CAAZ;AACA,UAAM;AAAEC,MAAAA;AAAF,QAAe,MAAMJ,GAAG,CAACK,WAAJ,CAAiBC,YAAD,IAAkB;AAC3D,UAAIA,YAAY,KAAK,IAArB,EAA2B;AACzB,eAAO,CAAP;AACD;;AAED,aAAOA,YAAY,GAAG,CAAtB;AACD,KAN0B,CAA3B;AAQA,WAAOR,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,MAAAA,KAAK,EAAEL,QAAQ,CAACM,GAAT;AADmB,KAArB,CAAP;AAGD;;AAED,MAAIb,GAAG,CAACE,MAAJ,KAAe,KAAnB,EAA0B;AACxB,UAAMK,QAAQ,GAAG,MAAMR,EAAE,CAACI,GAAH,CAAO,OAAP,EAAgBC,KAAhB,CAAsBJ,GAAG,CAACK,KAAJ,CAAUC,IAAhC,EAAsCQ,IAAtC,CAA2C,OAA3C,CAAvB;AACA,UAAMC,KAAK,GAAGR,QAAQ,CAACM,GAAT,EAAd;AAEA,WAAOZ,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,KAAK,EAAEG;AAAT,KAArB,CAAP;AACD;AACF,CAtBD","sourcesContent":["import db from '@/lib/firebase';\n\nexport default async (req, res) => {\n  if (req.method === 'POST') {\n    const ref = db.ref('views').child(req.query.slug);\n    const { snapshot } = await ref.transaction((currentViews) => {\n      if (currentViews === null) {\n        return 1;\n      }\n\n      return currentViews + 1;\n    });\n\n    return res.status(200).json({\n      total: snapshot.val()\n    });\n  }\n\n  if (req.method === 'GET') {\n    const snapshot = await db.ref('views').child(req.query.slug).once('value');\n    const views = snapshot.val();\n\n    return res.status(200).json({ total: views });\n  }\n};\n"]},"metadata":{},"sourceType":"module"}